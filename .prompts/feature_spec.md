# 기능 명세서: 회원가입 시 사용자 맞춤 여행지 추천

## 1. 목적
- **기술 부채 해결**: 수동 DB 구축 -> 자동 파이프라인 전환.
- **핵심 가치**: 단순 가중치가 아닌 '벡터 코사인 유사도' 기반 정밀 추천.

## 2. 데이터 파이프라인 (Flow)
1.  **Batch**: 크롤링(Wiki/Web) → LLM 정규화 → 임베딩 → Vector DB(PgVector) 저장.
2.  **Real-time**: User Query 벡터화 → Cosine Similarity 계산 → Top 10 추출.
3.  **Reranking**: LLM이 하드 제약(비행시간, 기후 등) 검증 및 순위 재조정.
4.  **Final**: 개인화된 추천 사유 생성 및 반환.

## 3. 핵심 로직
- **입력 A (Context)**: 설문 답변을 자연어 문장으로 변환하여 벡터화.
- **입력 B (Multiplier)**: 예산을 절대 금액이 아닌 '지출 성향(뉴욕=100 기준)'으로 변환.
- **매칭 알고리즘**:
    - 유사도: Cosine Similarity (소수점 10자리).
    - 예산: Distance Scoring (`|도시물가 - 사용자예산|` 최소화).

## 4. 예외 처리
- **데이터 부재**: LLM 파싱 실패 시 원본 텍스트 검색.
- **폴백(Fallback)**: 조건 불충족 시 근사치 도시 추천 + 안내 메시지.

## 5. 검증 포인트
- **정상 케이스**: 취향(역사/문화)에 맞는 벡터 인접 도시가 상위권인가?
- **경계값**: 극단적 예산(Low/High)에 따른 물가 매칭 정확도.
